import { action, autorun, observable, extendObservable, computed, toJS} from 'mobx';
import { UIStore } from '../stores';
import * as API from '../api';


export default class Profile {
  @observable is_worker = true;
  @observable isSaved = false;

  constructor(obj) {
    console.log('Profile constructor obj: ', obj);
    extendObservable(this, initialData);
    autorun(() => {
      console.log('Profile is ', this.is_worker ? 'worker' : 'employer');
    });
  }

  @computed get role() {
    return this.is_worker ? 'worker' : 'employer';
  }

  @action setRole(value) {
    if (value === 'worker') {
      this.is_worker = true;
    }
    else if (value === 'employer') {
      this.is_worker = false;
    }
  }

  @action setData(name, value) {
    this[name] = value;
  }

  @action save() {
    if (!this.isSaved) {
      UIStore.openDialog();
    }
  }

  async serverSave() {
    const response = await API.request(API.ENDPOINTS.PUT_PROFILE(this.id), toJS(this));
    if (response) {
      console.log('Profile post response teqt: ', response);
    }
  }

}


const initialData = {
  firstname: '',
  lastname: '',
  phone: '',
  city: '',
  edu: '',
  filmography: '',
  ad: '',
  languages: '',
  image: '',
  text: '',
};

